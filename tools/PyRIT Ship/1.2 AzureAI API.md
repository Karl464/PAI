
# ‚òÅÔ∏è Configuration & Connection Guide: Azure OpenAI

This guide merges the steps for account creation, credential validation, and advanced integration with the **PyRIT** framework.

---

## 1Ô∏è‚É£ Azure Resource Configuration

Before coding, you must have an active resource in the Microsoft cloud.

1. **Create Resource:** Access the [Azure Portal](https://portal.azure.com/) and create an **Azure OpenAI** resource.
2. **Deploy Model:** Enter [Azure AI Foundry](https://ai.azure.com/) (formerly AI Studio), go to the **Deployments** section, and deploy a model (e.g., `gpt-4o`).
3. **Get Credentials:** In the "Keys and Endpoint" tab of your resource, copy **Key 1** and the **Endpoint URL**.

Save these details in your `.env` file:

```env
AZURE_OPENAI_GPT4O_CHAT_ENDPOINT="https://your-resource.openai.azure.com/"
AZURE_OPENAI_GPT4O_CHAT_KEY="your-key-here"
AZURE_OPENAI_GPT4O_CHAT_DEPLOYMENT="your-deployment-name"
AZURE_OPENAI_API_VERSION="2024-02-01"

```

---

## 2Ô∏è‚É£ Install Dependencies

Ensure you have the official OpenAI libraries and environment tools installed:

```bash
pip install openai python-dotenv pyrit

```

* **SDK Documentation:** [OpenAI Python Library on GitHub](https://github.com/openai/openai-python).

---

## 3Ô∏è‚É£ Basic Connection Test (Without PyRIT)

Use this script to verify that your cloud connection is stable. This is the equivalent of the "Roman Empire" test from your original guide.

```python
import os
from openai import AzureOpenAI
from dotenv import load_dotenv

load_dotenv()

# Initialize the official Azure client
client = AzureOpenAI(
    api_key=os.getenv("AZURE_OPENAI_GPT4O_CHAT_KEY"),
    api_version=os.getenv("AZURE_OPENAI_API_VERSION"),
    azure_endpoint=os.getenv("AZURE_OPENAI_GPT4O_CHAT_ENDPOINT")
)

try:
    response = client.chat.completions.create(
        model=os.getenv("AZURE_OPENAI_GPT4O_CHAT_DEPLOYMENT"),
        messages=[{"role": "user", "content": "Write a short story about the Roman Empire."}],
        max_tokens=200
    )
    print(f"‚úÖ Connection Successful:\n{response.choices[0].message.content}")
except Exception as e:
    print(f"‚ùå Error: {e}")

```

---

## 4Ô∏è‚É£ Advanced Integration with PyRIT

To use Azure as an attack target or evaluator in PyRIT, you must use the `OpenAIChatTarget` class.

**Important Note:** You must initialize PyRIT memory before creating the object, or you will receive a "Central memory instance" error.

```python
from pyrit.common import initialize_pyrit, IN_MEMORY
from pyrit.prompt_target import OpenAIChatTarget

# 1. Initialize memory (Mandatory for PyRIT)
initialize_pyrit(memory_db_type=IN_MEMORY)

# 2. Configure the Azure target
azure_target = OpenAIChatTarget(
    model_name=os.getenv("AZURE_OPENAI_GPT4O_CHAT_DEPLOYMENT"),
    endpoint=os.getenv("AZURE_OPENAI_GPT4O_CHAT_ENDPOINT"),
    api_key=os.getenv("AZURE_OPENAI_GPT4O_CHAT_KEY")
)

```

* **PyRIT Guide:** [PyRIT Documentation / Prompt Targets](https://www.google.com/search?q=https://learn.microsoft.com/en-us/security/pyrit/).

---

## üîç Additional Resources

* **Usage Limits:** Review your quotas and consumption in [Azure Cost Management](https://www.google.com/search?q=https://portal.azure.com/%23blade/Microsoft_Azure_Billing/SubscriptionsBlade).
* **Content Filters:** Azure applies security filters by default. If your PyRIT tests are blocked, consult the [Azure Content Safety Guide](https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/content-filter).
* **Available Models:** Check which models are available by region in the [Azure Model Table](https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/models).